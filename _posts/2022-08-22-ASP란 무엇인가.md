---
layout: post
title:  "Asp 간단한 사용하기"
date:   2022-08-22 09:30:00 +0900
author: mclee
categories:  asp대해서 알아보자!
---
<hr/>

### ASP 란?
Active Server Page의 약자로 동적으로 서버에서 작동하는 페이지를 의미  
마이크로소프트 사에서 동적으로 웹 페이지들을 생성하기 위해 개발한 서버 측 스크립트 엔진입니다.  
그리고 서버 측 스크립트입니다. 그 의미는 서버 측에서 작업의 처리를 위해 사용하는 언어입니다.  
이에 반대되는 개념은 클라이언트 사이드라고 한다. 대표적인 언어는 자바 스크립트, VB 스크립트가 있다

잠깐 Server Side(서버 사이트), Client Side(클라이언트 사이드)에 알아 보자
1. Server Side란,  
 네트워크의 한 방식인 클라이언트-서버 구조의 서버쪽에서 행해지는 처리르 말한다.

장점:
 - 데이터 위조의 가능성을 줄일 수 있다
 - 민감한 데이터의 경우 서버 사이트로 처리를 할수 있다
 - 클라이언트 컴퓨터의 처리 부담을 줄일 수 있다  

단점:
 - 서버의 처리 부담이 커져 결과적으로 서버 비요이 늘어날 수 있다

2. Client Side란,  
 네트워크의 한 방식인 클라이언트-서버 구조의 클라이언트쪽에서 행해지는 처리르 말한다.

장점:  
 - 서버의 처리 부담을 줄여서 서버의 비용을 줄일 수 있다
 - 클라이언트 내에서 처리 가능한 부분에 대해서는 통신에 대비하여 암호화할 필요가 없으므로 암호화 소요를 줄어들수 있다.  

단점:  
 - 클라이언트 사이트에서 처리한 결과를 되받아야 하는 경우는 진위성을 알기가 어럽다 데이터를 위조하기 쉽다
 - 클라이언트 컴퓨터의 처리 부담이 많아 진다

ASP는 <% %> 구분자 사이로 스크립트를 서버에서 실행이 됩니다.   
서버에서 실행 시 ASP 스크립트는 페이지 소스 보기 통해서 스크립트를 확인 할 수 없고 결과의 값만 확인이 가능합니다.


### 작동원리
웹사이트 이용자가 어떠한 ASP 페이지에 접속하면 이 ASP 페이지는 ASP.DLL을 거쳐 해석된 다음 HTML 태그로 바뀌어집니다.  
그럼 웹 브라우저가 이 HTML을 해석하여 화면에 보여주는 것입니다.

### HTML과 ASP의 차이점

전송 과정에서도 차이가 있습니다.  
결론만 이야기 하자면 코드 해석 과정을 거치느냐 안거치냐의 차이점에 있습니다.

HTML은  
① 웹브라우저에서 서버로 문서 요청  
② 웹서버 파일시스템에서 문서검색(index.html, images...등)  
③ 문서를 웹브라우저에 전달

ASP는  
① 웹브라우저에서 서버로 문서요청  
② 웹서버 파일시스템에서 문서검색(index.html, home.asp, images...등)  
③ ASP.DLL(asp코드 해석)  
④ 문서를 웹브라우저에 전달

### ASP를 사용하는 이유  
나모나 HTML로 홈페이지를 만들어 본 사람들은 어느 정도 시간이 지나면 자기의 생각을 홈페이지에서 마음대로 구현할 수 없다는 것에 실망을 하게 될 것입니다.  
자바스크립트도 해 보고 플래쉬도 해 보지만 역시 만족스럽지 못합니다.  
이 때 눈을 돌리게 되는 것이 ASP라고 할 수 있습니다. 물론 대신에 CGI나 PHP라는 말도 많이 듣을 수 있습니다.  
그러면 사람들은 왜 ASP를 사용하고 있을까요?


#### ① 사용자와의 동적인 상호작용을 원하기 때문입니다.  
HTML은 기본적으로 정보를 보여주기만 합니다. 하이퍼링크를 통해 사용자가 요청을 하면 웹서버가 그 요청에 응답하여 원하는 웹 페이지를 보여주는 방식으로 작업이 진행됩니다.  
그것도 일종의 상호작용이라고 할 수는 있겠지만 웹 서버를 운영하는 사람과 사용자가 서로 어떤 정보를 주고 받는다든지 아니면 사용자들간에 서로 정보를 주고 받는다든지 하는 일은 기본적으로 불가능합니다.  
ASP는 HTML로 불가능한 이런 일들을 가능하게 해 줍니다.

#### ② 서버측 자원을 사용해야 하는 경우입니다.  
사용자로부터 어떤 내용을 입력받아 데이터베이스에 저장해야 할 경우와 같은건데 이럴 경우는 반드시 ASP를 사용해야만 합니다.  
예를 들어 게시판 작성, 파일 업로드, ID 인증 등과 같이 서버에 어떤 정보를 저장하거나 저장된 정보를 이용해 일을 하는 경우에는 ASP를 사용해야만 합니다.  
왜냐하면 HTML은 원칙적으로 클라이언트에서 번역되는 문서이기 때문에 서버의 다른 자원에 접근할 수가 없기 때문입니다.

#### ③ 스크립트의 안정적인 실행을 위해서입니다.  
자바스크립트를 예를 들어 보겠습니다. 자바스크립트도 날이 갈수록 버전이 높아지고 있습니다.  
그러다보면 상위 버전의 자바스크립트를 삽입한 HTML문서가 어떤 웹 브라우저에서는 의도하는대로 번역이 되지 않는 사태가 벌어질 수도 있습니다.  
이럴 경우 서버에서 실행되는 스크립트라면 서버에서 HTML형태로 번역된 후 넘겨지게 되니까 어떤 웹 브라우저에서라도 잘못될 염려가 없을 것입니다.

#### ④ 스크립트 소스를 감추기 위해서입니다.  
클라이언트측 스크립트들은 HTML 속에 포함되어 서버에서 클라이언트로 전송된 다음 클라이언트의 웹 브라우저에서 번역됩니다.  
따라서 사용자들은 소스보기를 통해 스크립트의 내용을 볼 수가 있습니다. 그러나, 서버측 스크립트를 사용함으로써 개발자는 자신의 독특한 알고리즘을 감출 수가 있습니다.  
물론 이런 목적을 위해 ASP를 사용한다는 것을 좋다고 할 수는 없겠지만 이런 기술로 밥먹고 사는 사람들에게는 꼭 필요한 것이 아닐까 생각됩니다.


##문법

간단한 예제를 만들어 보았습니다.  
1. 리턴하는 함수
2. 리턴 안하는 함수
common.asp
```asp
<%
    Public Function calculation(a, b)
        calculation = a + b
    end Function
    sub resultWrite(result)
        response.write "계산 완료된 값 : "& result & "<br>"
    end sub
%>
```
3. 파일 인클루드 하기
4. if 문
5. for 문
index.asp
```asp
<head>
<%
    Dim a, b, result
%>
<!--	#include file="../common.asp"  -->
</head>
<body>
    <div>
        <%
            a = 1
            b = 2
            result = calculation(a, b)
            
            if result < 2 then
               result = 0
            end if
            Dim i, res
            for i = 0 to 5
               res = result * i
               resultWrite(res)
            next
            resultWrite(result)
        %>
        <span><%= result %></span>
    </div>
</body>
<script>
    ...
</script>
```


## [출처]
1. ASP란 무엇인가 : https://genesis8.tistory.com/251?category=173212
2. ASP란 무엇인가?|작성자 김자까 : https://blog.naver.com/PostView.naver?blogId=rlarbtjq7913&logNo=221719016736&redirect=Dlog&widgetTypeCall=true&directAccess=false